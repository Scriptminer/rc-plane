<!DOCTYPE html>
<html>
<head>
<title>FLIGHT STATUS</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style>

{ margin: 0; padding: 0; }

html {
		background-color: #ccc;
        background: url('FighterBackground.png') no-repeat center center fixed;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
}

</style>
<script src="jquery.min.js"></script>
<script>

var boxWidth = 24; // (25vw) 1/4 of viewport width
var boxHeight = boxWidth*0.55;
var tableMargin = (100-(boxWidth*4))/5; // NOT css margin!
var headingSize = boxWidth/6.5;

function setupDisplay(){
	///// DIV SETUP /////


	// Controls
	var controls = [{name:"Ailerons",symbol:"°",mes:"Roll"}, // mes = measure type, mesS = measure symbol
	                {name:"Elevator",symbol:"°",mes:"Pitch"},
	                {name:"Rudder",symbol:"°",mes:"Yaw"},
	                {name:"Throttle",symbol:"%",mes:"Speed"}]; // Throttle is special case - variable will be entered seperately
	for(var i=0; i<controls.length; i++){
		var n  = controls[i].name;
		var s  = controls[i].symbol;
		var m  = controls[i].mes;
		document.getElementById("tableContainer").innerHTML += '<div id="'+ n +'Box" class="controlBox"><span class="controlTitle"><i><b>'+ n.toUpperCase() +'</b></i></span><br><span class="controlContainer">'+
															   '<span id="input'+ n +'line">Input: <span id="input'+ n +'"></span>'+ s +'</span><br>'+
															   '<span id="control'+ n +'line">Control Surface: <span id="servo'+ n +'"></span>'+ s +'</span><br>'+
															   '<span id="error'+ n +'line">Error/Difference: <span id="error'+ n +'"></span>'+ s +'</span><br>'+
															   '<span id="sensor'+ n +'line">Sensor'+ m +': <span id="sensor'+ n +'"></span>'+ s +'</span><br>'+
															   '</span></div>';
		//var offset = ((100-(boxWidth*4))/5*(i+1))+(boxWidth*i); // 100 [full width] - (boxWidth*4) [space used up] /5 [split over 5 gaps]
		//$("#"+n+"box").css({"position":"relative","left":offset+"vw"});
	}
	document.getElementById("tableContainer").innerHTML += '<div id="LogBox" class="controlBox"><span id="logTitle" class="controlTitle"><b><i>CURRENT FLIGHT LOG:</i></b><br>'+
														   '<sup class="subnote"><i>(Newest First)</i></sup></span><br>'+
														   '<span class="logText"></span>'+
														   '</div>';

	///// STYLES SETUP /////
	//$(".controlBox").width(boxWidth+"vw");
	$(".controlBox").css({"background":"rgba(130,130,130,0.3)","width":boxWidth+"vw","height":boxHeight+"vw"});
	$(".controlTitle").css({"color":"#03a", "font-size":headingSize+"vw"});
	$(".controlContainer").css({"font-size":(headingSize/2)+"vw","line-height":"110%"});
	$(".subnote").css({"color":"#88a", "font-size":"60%"});

	$("#tableContainer").css({"position":"relative"});
	$("#LogBox").css({"width":(boxWidth*2)+"vw","height":(boxHeight*2)+"vw"});
	$("#topHeading").css({"color":"black","font-size":(headingSize*1.2)+"vw","line-size":"70%"});
	$("#logTitle").css({"color":"#30a","font-size":(headingSize*0.90)+"vw","line-height":"110%"});

	///// TABLE POSITION SETUP /////
	var positions = [	["AileronsBox","LogBox"], // First ROW
					    ["ElevatorBox"], // Second ROW
					    ["RudderBox"], // Third ROW
					    ["ThrottleBox"], // Fourth ROW
					];
	var offsetTop = 0;
	for(var x=0;x<positions.length;x++){
		offsetTop += tableMargin;
		var offsetLeft = 0;
		for(var y=0;y<positions[x].length;y++){
			if(positions[x][y] != ""){
				var objWidth = parseInt(document.getElementById(positions[x][y]).style.width); // Should take "24vw" and output 24 as a number
				var objHeight = parseInt(document.getElementById(positions[x][y]).style.height);
			}
			offsetLeft += tableMargin;
			$("#"+positions[x][y]).css({"position":"absolute","left":offsetLeft+"vw","top":offsetTop+"vw"});
			offsetLeft += objWidth;
		}
		offsetTop += boxHeight;
	}
}

/*var linkVars = {"inputAILERONS"	 	:function(){return aileronsIn;},
				"controlAILERONS"	:function(){return aileronsCtrl;},
				"errorAILERONS" 	:function(){aileronsErr = aileronsCtrl-;return aileronsErr;},
				"sensorAILERONS" 	:function(){return aileronsSns;},

				"inputELEVATOR"	 	:function(){return elevatorIn;},
				"controlELEVATOR"	:function(){return elevatorCtrl;},
				"errorELEVATOR" 	:function(){return elevatorErr;},
				"sensorELEVATOR" 	:function(){return elevatorSns;},

				"inputRUDDER"	 	:function(){return rudderIn;},
				"controlRUDDER"		:function(){return rudderCtrl;},
				"errorRUDDER" 		:function(){return rudderErr;},
				"sensorRUDDER" 		:function(){return rudderSns;},

				"inputTHROTTLE"	 	:function(){return throttleIn;},
				"controlTHROTTLE"	:function(){return throttleCtrl;},
				"errorTHROTTLE" 	:function(){return throttleErr;},
				"sensorTHROTTLE" 	:,
				}
var vs = { // List of ALL variables to be displayed
		"aileronIn":"--","elevatorIn":"--","rudderIn":"--","throttleIn":"--",
		"aileronCtrl":"--", 	"elevatorCtrl":["--",controlELEVATOR],	"rudderCtrl":["--",controlRUDDER],"throttleCtrl":["--",controlAILERONS],
		"aileronErr": ["--",errorAILERONS], 	"elevatorErr":["--",errorELEVATOR],		"rudderErr":["--",errorRUDDER],"throttleErr":["--",errorAILERONS],
		"rollSensor": ["--",sensorAILERONS], 	"pitchSensor":["--",sensorELEVATOR],	"yawSensor":["--",sensorRUDDER],"speedSensor":["--",sensorAILERONS],
		  };*/




function updateDisplay(){
	for(var i=0; i<linkVars.length; i++){
		var vi = linkVars[i]; // "vi" short for: linkVars i
		document.getElementById(vi.id).innerHTML = vs[vi.link];
	}
}

var flashingErrors = {};
var flashLength = 100;

function flashError(id,toggle){
	if(toggle == true){ // Turn on error-flashing
		//console.log(flashingErrors.id);
		if(flashingErrors[id] == undefined){ // If this id does not already have an error-flashng loop
			flashingErrors[id] = setInterval(function(){errFlashLoop();},flashLength);
			$("#"+id).css("color","#d00");
		}
	}else{ // Turn off error-flashing
		if(flashingErrors[id]){ // If there is an error-flashing loop to remove
			clearInterval(flashingErrors[id]);
			delete flashingErrors[id];
			$("#"+id).css("color","#000");
		}else{
			console.log("There was no error-flashing loop to remove from id: "+ id);
		}
	}
	var errFlashLoop = function(){
		var d = new Date();
		var m = d.getMilliseconds();
		var n = Math.round(d.getMilliseconds()/flashLength);

		$("#"+id).css("color","#d00"); // Set color to red (if it wasn't already, to end previous flash)
		if(n == 1 || n == 6){ // Flash Twice per second
			$("#"+id).css("color","#dd0"); // Flash Yellow
		}
	}
}

</script>
</head>
<body onload="setupDisplay(); //updateDisplay();">
<span id="topHeading"><u><b>Aidan's Flight Tracker Following: <span style="color:#00d">BLUE-FIREBIRD v1</span> <span style="color:#0ad">Flight --001</span></b></u></span>
<br>
<br>
<br>
<div id="tableContainer"></div>
</body>
</html>